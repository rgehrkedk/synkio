# Troubleshooting Guide

Common issues and solutions when using the Synkio Figma plugin.

## Connection Issues

### "GitHub authentication failed"

**Cause**: Your GitHub token is invalid or expired.

**Solution**:
1. Go to [github.com/settings/tokens](https://github.com/settings/tokens)
2. Check if your token has expired
3. Generate a new token with `repo` scope
4. Update the token in the plugin's Setup tab

### "Permission denied" / 403 Error

**Cause**: Your token doesn't have the required permissions.

**Solution**:
1. Ensure your token has the `repo` scope (for private repos) or `public_repo` (for public repos)
2. For Fine-Grained tokens, ensure "Contents: Read and write" is enabled
3. If creating PRs, ensure "Pull requests: Read and write" is enabled

### "Resource not found" / 404 Error

**Cause**: The repository, branch, or file path doesn't exist.

**Solution**:
1. Verify the repository owner and name are correct
2. Check that the branch exists (default is `main`)
3. Verify the file path (default: `synkio/export-baseline.json`)
4. Ensure the file has been committed to the repository

### "Network request failed"

**Cause**: Figma can't reach GitHub's API.

**Solution**:
1. Use Figma Desktop (not the web version) — network access requires the desktop app
2. Check your internet connection
3. Verify `api.github.com` isn't blocked by your firewall or VPN

## Sync Issues

### "No changes detected" but I made changes

**Cause**: Changes might be in excluded collections or the plugin hasn't re-scanned.

**Solution**:
1. Go to the **Tokens** tab
2. Ensure the relevant collections aren't excluded
3. Click **Refresh** to re-scan variables
4. Try closing and reopening the plugin

### Variables aren't showing up

**Cause**: Variables might be in a different file or not properly created.

**Solution**:
1. Ensure variables are created in the current file (not a linked library)
2. Variables must be in a Variable Collection
3. Check that the collection isn't excluded in the Tokens tab

### Styles aren't syncing

**Cause**: Style types might be excluded or styles aren't local.

**Solution**:
1. Go to the **Tokens** tab
2. Check that the style type (Paint, Text, Effect) isn't excluded
3. Ensure styles are local to the file (not from a library)

### "Invalid baseline format" error

**Cause**: The fetched JSON file is malformed or not a valid baseline.

**Solution**:
1. Verify you're fetching the correct file (`export-baseline.json`, not `baseline.json`)
2. Check the file contains valid JSON
3. Ensure the file was generated by `synkio export-baseline` command
4. Look for syntax errors if the file was manually edited

## PR Creation Issues

### "Failed to create branch"

**Cause**: Branch already exists or permission issues.

**Solution**:
1. Check if a branch with the same name already exists
2. Ensure your token has write access to the repository
3. Verify you're not trying to push to a protected branch

### "Failed to create pull request"

**Cause**: PR already exists or repository settings block PRs.

**Solution**:
1. Check if a PR already exists from the same branch
2. Ensure the repository allows PR creation
3. Verify the base branch (usually `main`) exists

## Plugin Issues

### Plugin won't load

**Cause**: Build error or invalid manifest.

**Solution**:
1. Run `npm run build` and check for errors
2. Verify `dist/code.js` and `dist/ui.html` exist
3. Check the Plugin ID in `manifest.json` is valid
4. Reload the plugin in Figma

### Plugin crashes or freezes

**Cause**: Large files or memory issues.

**Solution**:
1. Close other Figma files to free memory
2. If syncing many variables, try syncing one collection at a time
3. Check the console for error messages (Plugins → Development → Show/Hide Console)

### "Cannot read properties of undefined"

**Cause**: Plugin state is corrupted.

**Solution**:
1. Close and reopen the plugin
2. If issues persist, go to Setup → Clear All Data
3. Reconfigure your connection settings

## Data Issues

### Lost my baseline after clearing data

**Cause**: Clear All Data removes locally stored baselines.

**Solution**:
1. The baseline in your code repository is unaffected
2. Run `synkio pull` to re-sync from your Figma file
3. The baseline will be recreated on the next sync

### Duplicate variables after sync

**Cause**: Variable IDs weren't preserved during import.

**Solution**:
1. This can happen when importing from files without variable IDs
2. Delete the duplicate variables in Figma
3. Re-sync to establish the ID mapping

## Debug Mode

Enable debug mode for detailed logging:

1. Press `Ctrl+Shift+D` (or `Cmd+Shift+D` on Mac) while the plugin is open
2. Open Figma's console: Plugins → Development → Show/Hide Console
3. Look for `[synkio]` prefixed log messages

## Getting Help

If none of these solutions work:

1. Enable debug mode and capture the console output
2. Note the exact error message
3. Open an issue at [github.com/rgehrkedk/synkio/issues](https://github.com/rgehrkedk/synkio/issues)

Include:
- Figma version
- Plugin version
- Error message
- Steps to reproduce
- Debug console output (if available)
